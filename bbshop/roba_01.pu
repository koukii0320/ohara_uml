@startuml
title 通信販売サイト - 注文手続き ロバストネス図

actor 顧客

' コントローラ（制御役）
control 注文管理コントローラ
control 決済コントローラ
control 在庫確認コントローラ

' エンティティ（情報資産）
entity 商品
entity カート
entity 注文
entity 顧客情報
entity 決済情報

' 境界（画面）
boundary 購入手続き画面
boundary 在庫切れ画面
boundary 注文完了画面
boundary 決済エラー画面

' 関係
顧客 --> 購入手続き画面 : 注文手続き開始
購入手続き画面 --> 注文管理コントローラ : 注文内容送信
注文管理コントローラ --> 在庫確認コントローラ : 在庫確認依頼
在庫確認コントローラ --> 商品 : 在庫確認

在庫確認コントローラ --> 在庫切れ画面 : 在庫不足通知

注文管理コントローラ --> カート : 注文内容取得
注文管理コントローラ --> 顧客情報 : 配送先取得
注文管理コントローラ --> 決済コントローラ : 決済依頼
決済コントローラ --> 決済情報 : 決済処理

決済コントローラ --> 注文完了画面 : 決済成功
決済コントローラ --> 注文 : 注文データ作成
決済コントローラ --> 決済エラー画面 : 決済失敗

@enduml
